@page "/passwords"



<MudContainer MaxWidth="MaxWidth.Medium" Class="pa-4">

    <MudStack Row="true" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center" Class="mb-4">
        <MudText Typo="Typo.h5">Your Passwords</MudText>

        <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1">
            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="OpenAddDialog">
                <MudIcon Icon="@Icons.Material.Filled.Add" Class="mr-2" /> Add Password
            </MudButton>
            <MudButton Variant="Variant.Outlined"
                       Color="Color.Secondary"
                       OnClick="BackupPasswords">
                <MudIcon Icon="@Icons.Material.Filled.Backup" Class="mr-2" />
                Backup Passwords
            </MudButton>
        </MudStack>

    </MudStack>

    <!-- Search Bar -->
    <MudTextField @bind-Value="_searchTerm" Immediate="true" Placeholder="Search..."
                  Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search"
                  Class="mb-4" />

    <!-- Passwords Table -->
    <MudTable Items="_filteredPasswords" Hover="true" Bordered="true" Striped="true" Dense="true">

        <HeaderContent>
            <MudTh>
                <MudIcon Icon="@Icons.Material.Filled.VpnKey" Color="Color.Primary" Class="mr-2" />
                Title
            </MudTh>
            <MudTh>
                <MudIcon Icon="@Icons.Material.Filled.Person" Color="Color.Secondary" Class="mr-2" />
                Username
            </MudTh>
            <MudTh>
                <MudIcon Icon="@Icons.Material.Filled.Password" Color="Color.Primary" Class="mr-2" />
                Password
            </MudTh>
            <MudTh>
                <MudIcon Icon="@Icons.Material.Filled.Settings" Color="Color.Primary" Class="mr-2" />
                Actions
            </MudTh>
        </HeaderContent>

        <RowTemplate>
            <MudTd DataLabel="Title">
                @context.Title
            </MudTd>

            <MudTd DataLabel="Username">
                @context.Username
                <MudTooltip Text="Copy Username">
                    <MudIconButton Icon="@Icons.Material.Filled.ContentCopy"
                                   Color="Color.Primary"
                                   Size="Size.Small"
                                   OnClick="@(() => CopyToClipboard(context.Username))"
                                   Class="ml-1" />
                </MudTooltip>
            </MudTd>

            <MudTd DataLabel="Password">
                <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1">
                    <MudTextField Value="@GetPasswordDisplay(context)"
                                  InputType="@GetPasswordInputType(context)"
                                  ReadOnly="true"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@GetPasswordIcon(context)"
                                  OnAdornmentClick="@(() => TogglePasswordVisibility(context))"
                                  Class="flex-grow-1" />
                    <MudTooltip Text="Copy Password">

                        <MudIconButton Icon="@Icons.Material.Filled.ContentCopy"
                                       Color="Color.Primary"
                                       Size="Size.Small"
                                       OnClick="@(() => CopyToClipboard(context.Password))" />
                    </MudTooltip>

                </MudStack>
            </MudTd>

            <MudTd DataLabel="Actions">
                <MudIconButton Icon="@Icons.Material.Filled.Info"
                               Color="Color.Primary"
                               OnClick="@(() => OpenAdditionalDataDialog(context))" />
                <MudIconButton Icon="@Icons.Material.Filled.Edit"
                               Color="Color.Primary"
                               OnClick="@(() => OpenUpdateDialog(context))" />
                <MudIconButton Icon="@Icons.Material.Filled.Delete"
                               Color="Color.Error"
                               OnClick="@(() => ConfirmDelete(context))" />
            </MudTd>
        </RowTemplate>
    </MudTable>

</MudContainer>