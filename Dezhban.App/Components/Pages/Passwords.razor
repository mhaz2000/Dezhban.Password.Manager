@page "/passwords"



<MudContainer MaxWidth="MaxWidth.Medium" Class="pa-4">

    <MudStack Row="true" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center" Class="mb-4">
        <MudText Typo="Typo.h5">Your Passwords</MudText>

        <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="OpenAddDialog">
            <MudIcon Icon="@Icons.Material.Filled.Add" Class="mr-2" /> Add Password
        </MudButton>
    </MudStack>

    <!-- Search Bar -->
    <MudTextField @bind-Value="_searchTerm" Immediate="true" Placeholder="Search..."
                  Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search"
                  Class="mb-4" />

    <!-- Passwords Table -->
    <MudTable Items="_filteredPasswords" Hover="true" Bordered="true" Striped="true" Dense="true">

        <HeaderContent>
            <MudTh>
                <MudIcon Icon="@Icons.Material.Filled.VpnKey" Color="Color.Primary" Class="mr-2" />
                Title
            </MudTh>
            <MudTh>
                <MudIcon Icon="@Icons.Material.Filled.Person" Color="Color.Secondary" Class="mr-2" />
                Username
            </MudTh>
            <MudTh>Password</MudTh>
            <MudTh>Actions</MudTh>
        </HeaderContent>

        <RowTemplate>
            <MudTd DataLabel="Title">
                @context.Title
            </MudTd>

            <MudTd DataLabel="Username">
                @context.Username
                <MudIconButton Icon="@Icons.Material.Filled.ContentCopy"
                               Color="Color.Primary"
                               Size="Size.Small"
                               OnClick="@(() => CopyToClipboard(context.Username))"
                               Class="ml-1"
                               ToolTip="Copy Username" />
            </MudTd>

            <MudTd DataLabel="Password">
                <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1">
                    <MudTextField Value="@GetPasswordDisplay(context)"
                                  InputType="@GetPasswordInputType(context)"
                                  ReadOnly="true"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@GetPasswordIcon(context)"
                                  OnAdornmentClick="@(() => TogglePasswordVisibility(context))"
                                  Class="flex-grow-1" />
                    <MudIconButton Icon="@Icons.Material.Filled.ContentCopy"
                                   Color="Color.Primary"
                                   Size="Size.Small"
                                   OnClick="@(() => CopyToClipboard(context.Password))"
                                   ToolTip="Copy Password" />
                </MudStack>
            </MudTd>

            <MudTd DataLabel="Actions">
                <MudIconButton Icon="@Icons.Material.Filled.Edit"
                               Color="Color.Primary"
                               OnClick="@(() => OpenUpdateDialog(context))" />
                <MudIconButton Icon="@Icons.Material.Filled.Delete"
                               Color="Color.Error"
                               OnClick="@(() => ConfirmDelete(context))" />
            </MudTd>
        </RowTemplate>
    </MudTable>

</MudContainer>